.. meta::
   :description: Краткое руководство по LibreOffice: Глава 12 – Создание веб-страниц
   :keywords: LibreOffice, Writer, Impress, Calc, Math, Base, Draw, либреоффис

.. _Creating-Web-Pages:


Глава 12 – Создание веб-страниц
================================================

В этой главе описывается, как сделать в Writer, Calc, Impress и Draw следующее: 

* Создание гиперссылок внутри документа и на другие документы, такие как веб-страницы, PDF и другие файлы. 
* Сохранять документы, как веб-страницы (документы HTML).

При создании документа, который вы планируете использовать, как веб-страницу, необходимо учитывать следующее: 

* В HTML документе гиперссылки активные (на них можно щелкать и переходить по соответствующим адресам), а другие перекрестные ссылки, вставляемые LibreOffice, таковыми не являются. 
* Объект, такой как изображение, сохранится в отдельном файле. Однако, если этот объект был помещен во врезку или фрейм (например, с соответствующей надписью), то он не сохранится и не появится в HTML документе, на экране появится только имя фрейма. 

Относительные и абсолютные гиперссылки 
--------------------------------------

Гиперссылки, хранящиеся в файле, могут быть абсолютными или относительными. 

Относительная гиперссылка содержит сведения о том, как попасть в какое-то место, начиная с того места, где документ находится сейчас (то есть из папки, в которой сохранён текущий документ), а абсолютная гиперссылка содержит сведения о месте назначения, которые позволят перейти туда, независимо от того, где расположен документ.
Абсолютная ссылка будет работать, если цель ссылки переместится. Относительная ссылка перестанет работать, если изменить местоположение начального и целевого места относительно друг друга. Например, если есть две таблицы в одной папке, связанных друг с другом, и вся папка будет перемещена в новое место, то абсолютная гиперссылка сломается, а относительная нет.

Чтобы изменить способ, которым LibreOffice сохраняет гиперссылки в файле, в меню :menuselection:`Сервис --> Параметры --> Загрузка/Сохранение --> Общие` выберите в разделе *Сохранение* вариант *Относительные пути к файлам* или *Относительные интернет адреса* или оба.

Calc всегда будет отображать абсолютную гиперссылку. Не пугайтесь, когда он делает это, даже если сохранена относительная гиперссылка. Этот «абсолютный» адрес будет обновляться, если файл переместить.

.. note:: Убедитесь, что структура каталогов на вашем компьютере такая же, как структура на веб-сервере, если сохраняете ссылки и собираетесь загрузить страницы в Интернет.

.. tip:: Если навести курсор мыши на гиперссылку, отобразится всплывающая подсказка с абсолютной ссылкой, поскольку внутри LibreOffice используется абсолютная адресация. Полный путь и адрес можно увидеть только при просмотре результата экспорта в HTML (сохранение таблицы в качестве HTML файла), а затем загрузки HTML файла в виде текста или, открыв его в текстовом редакторе.

Создание гиперссылки
--------------------

При вводе текста (например, адреса веб-сайтов или URL), который может быть использован в качестве гиперссылки, нажмите клавишу пробел или клавишу ``Enter``. LibreOffice автоматически создает гиперссылку и применит форматирование к тексту (как правило цвет и подчеркивание). Если это не произойдет, то можно включить эту функцию, выбрав в меню :menuselection:`Сервис --> Параметры автозамены` на вкладке *Параметры* опцию *Распознавать URL-адреса*.

Если вы не хотите чтобы LibreOffice производил преобразование конкретного URL в гиперссылку, выберите пункт меню :menuselection:`Правка --> Отменить` или нажмите сочетание клавиш ``Ctrl + Z`` сразу же после применения форматирования, или поместите курсор на гиперссылку, нажмите правой кнопкой мыши и выберите в контекстном меню пункт *Удалить гиперссылку*. 

.. tip:: Чтобы изменить цвет гиперссылки, в меню :menuselection:`Сервис --> Параметры --> LibreOffice --> Внешний вид` в списке *Настройка цветов* найдите пункт *Не посещённые ссылки* и/или *Посещённые ссылки*, выберите для них новый цвет и нажмите *OK*. Внимание: это изменение цвета гиперссылки будет применено во всех компонентах LibreOffice; возможно это не требуется.

 В Writer и Calc (но не в Draw или Impress) также можно изменить стиль символов интернет-ссылки  или определить и применить новый стиль для выбранных ссылок.
 
Использование Навигатора
-------------------------

Можно вставлять гиперссылки, используя *Навигатор*. Это простой способ вставить гиперссылку на другую часть этого же документа. 

1) Откройте документы, содержащие элементы, на которые нужно создать перекрестную ссылку.

2) Нажмите на значок *Навигатор*  или выберите пункт меню :menuselection:`Вид --> Навигатор` |ch12-lo-screen-001|, или нажмите клавишу ``F5``, чтобы открыть окно *Навигатор*.

.. |ch12-lo-screen-001| image:: _static/chapter12/ch12-lo-screen-001.png
        :scale: 90% 

3) Нажмите на треугольник справа от значка *Режим перетаскивания* и выберите пункт *Вставить как гиперссылку*. Значок Режим перетаскивания по умолчанию выглядит, как значок *Гиперссылка* |ch12-lo-screen-002|.

.. |ch12-lo-screen-002| image:: _static/chapter12/ch12-lo-screen-002.png
        :scale: 70% 

4) Выберите документ из выпадающего списка в нижней части *Навигатора*, который содержит элемент, на который вы хотите создать перекрестную ссылку. 

5) В списке *Навигатора*, выберите элемент, который вы хотите добавить в качестве гиперссылки.

6) Перетащите элемент на место в документе, куда нужно вставить гиперссылку. Имя элемента будет вставлено в документ в качестве активной гиперссылки.

.. _ch4-lo-screen-003:

.. figure:: _static/chapter12/ch12-lo-screen-003.png
    :scale: 60%
    :align: center
    :alt: Вставка гиперссылки, используя Навигатор

    Вставка гиперссылки, используя *Навигатор*

При использовании *Навигатора* для вставки гиперссылки на объект, например, график, рекомендуется дать гиперссылке узнаваемое имя, например, «График продаж за 2009 год» . Необходимо задавать имена таким объектам, а не оставлять имя по умолчанию, например, «График_6», иначе придется изменять имя результирующей ссылки с помощью диалога Гиперссылка, как описано ниже. 

Также можно использовать *Навигатор* для вставки гиперссылки из одного документа (источника) в определенное место другого документа (цели).

Использование диалога Гиперссылка
---------------------------------

Диалог *Гиперссылка* используется для вставки гиперссылки и изменения всех гиперссылок в документе:

1) Выделите существующий текст, который будет использоваться, как ссылка.

2) Нажмите на значок *Гиперссылка* |ch12-lo-screen-002| на стандартной панели инструментов или выберите пункт меню :menuselection:`Вставка --> Гиперссылка`, чтобы открыть одноименный диалог.

.. |ch12-lo-screen-002| image:: _static/chapter12/ch12-lo-screen-002.png
        :scale: 70% 

3) В левой части выберите одну из четырёх категорий гиперссылки:

* *Интернет*: гиперссылка указывает на веб-адрес, как правило, начинается с ``http://``.
* *Почта и новости*: гиперссылка открывается, как сообщение электронной почты, предварительно адресованное конкретному получателю. 
* *Документ*: гиперссылка указывает на другой документ или на другое место в текущем документе.
Создать документ: гиперссылка создает новый документ.

.. _ch4-lo-screen-004:

.. figure:: _static/chapter12/ch12-lo-screen-004.png
    :scale: 60%
    :align: center
    :alt: Диалог Гиперссылка. Настройки для ссылки в Интернет

    Диалог *Гиперссылка*. Настройки для ссылки в Интернет

4) Настройки в этом диалоговом окне изменяются в зависимости от типа выбранной гиперссылки. Введите все необходимые данные для создания гиперссылки. 

5) Нажмите кнопку *Применить*, чтобы создать гиперссылку. Диалог *Гиперссылка* останется открытым, позволяя создавать другую гиперссылку. 

6) Нажмите кнопку *Закрыть*, чтобы закрыть диалог.

Вид диалога меняется в зависимости от выбора категории гиперссылки в левой панели. Полное описание всех вариантов и их взаимодействия выходит за рамки этой главы. Вот краткое изложение наиболее распространенных вариантов:

* Для гиперссылки *Интернет*: выберите тип гиперссылки (Интернет или FTP) и введите требуемый адрес (URL).

* Для гиперссылки *Почта и новости*: выберите почту или новости, введите адрес получателя и тему для письма.

* Для гиперссылки *Документ*: укажите путь до документа (нажатие на кнопку *Открыть файл* открывает обозреватель файлов) или оставьте это поле пустым, если хотите установить ссылку в этом же документе. При необходимости укажите *Цель в документе* (например некий конкретный слайд или изображение). Нажмите на кнопку *Ссылка на элемент документа*, чтобы открыть одноименное окно, где вы можете выбрать тип цели, или, если известно имя цели, можно ввести его в поле.

* Для гиперссылки *Создать документ*: укажите, следует ли немедленно изменить вновь созданный документ (вариант *Редактировать сейчас*), или просто создать его (вариант *Редактировать позже*). Введите имя файла и выберите тип создаваемого документа (текст, электронная таблица и т.д.). Нажмите на кнопку *Выбрать путь*, чтобы открыть файловый браузер и выбрать, куда сохранить файл. 

Раздел *Дополнительные настройки* в нижней правой части диалогового окна является общим для всех категорий гиперссылок, хотя некоторые варианты актуальны только для некоторых типов гиперссылок. 

* Значение поля *Фрейм* определяет, как будет открыта гиперссылка. Это относится к документам, которые открываются в веб-браузере. 

* Значение поля *Форма* определяет, будет ли ссылка представлена в виде текста или в виде кнопки. Смотрите *Руководство по Writer* *Глава 15 — Использование форм во Writer*, для получения дополнительной информации. 

В поле *Текст* вводится текст, который будет показан пользователю в качестве имени гиперссылки. Если в этом поле ничего не вводить, то LibreOffice отобразит полный адрес или путь к файлу в качестве имени ссылки. Заметим, что если ссылка является относительной, а файл будет перемещён, то текст не изменится. 

* Значение в поле *Имя* применимо к HTML документам. Здесь задаётся текст, который будет добавлен в качестве имени атрибута в HTML код после гиперссылки. 

* События: нажмите на этот значок, чтобы открыть диалог Назначить макрос и выбрать макрос, который будет запускаться при нажатии на ссылку. Смотрите *Главу 13 — Начало работы с макросами* в этом руководстве для получения дополнительной информации.

Редактирование гиперссылок
~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы изменить существующую гиперссылку:

1) Установите курсор в тексте гиперссылки.
2) Нажмите на значок *Гиперссылка* |ch12-lo-screen-002| на стандартной панели инструментов или выберите пункт меню :menuselection:`Правка --> Гиперссылка`, или нажмите правой кнопкой мыши и выберите пункт контекстного меню *Изменить гиперссылку*. Откроется диалог *Гиперссылка*.
3) Внесите необходимые изменения и нажмите кнопку *Применить для сохранения*. Диалог останется открытым для возможности продолжения редактирования гиперссылок. Нажимайте кнопку *Применить для каждой отредактированной гиперссылки*.
4) После завершения редактирования нажмите кнопку *Закрыть*.

Стандартно (по умолчанию) для перехода по гиперссылке в LibreOffice используется сочетание клавиши ``Ctrl + щелчок мыши``. Это может быть изменено в меню :menuselection:`Сервис --> Параметры --> LibreOffice --> Безопасность`, нажмите на кнопку *Параметры* и снимите в появившемся окне флажок с пункта *Ctrl-щелчок необходим для перехода по гиперссылкам*. Если при простом нажатии на ссылку происходит переход, проверьте эту страницу настроек, чтобы уточнить активна ли данная опция. 

Удаление гиперссылок
~~~~~~~~~~~~~~~~~~~~

Можно удалить ссылку из гиперссылки и оставить только текст. Нажмите правой кнопкой мыши по гиперссылке и выберите пункт *Удалить гиперссылку* из контекстного меню. После этого к оставшемуся тексту возможно придется повторно применить форматирование, чтобы внешний вид текста соответствовал остальной части документа. 

Чтобы стереть текст гиперссылки или кнопки из документа полностью, выберите их и нажмите клавишу ``Backspace`` или ``Delete``.

--------

Создание веб-страниц при помощи Веб-мастера
--------------------------------------------

Веб-мастер в LibreOffice позволяет создавать несколько типов стандартных веб-страниц и доступен из всех модулей LibreOffice. Однако, каждый раз, когда открывается веб-мастер из модуля LibreOffice, до появления окна веб-мастера будет автоматически запускаться Writer. Веб-мастер связан с Writer и, как правило, используется именно в Writer для создания веб-страниц.



Сохранение документа, как веб-страницы
--------------------------------------


Документы Writer
~~~~~~~~~~~~~~~~

Одна веб-страница
"""""""""""""""""

Серия веб-страниц
"""""""""""""""""

Электронные таблицы Calc
~~~~~~~~~~~~~~~~~~~~~~~~~

Презентации Impress
~~~~~~~~~~~~~~~~~~~



Документы Draw
~~~~~~~~~~~~~~

Документы Draw не могут быть сохранены, как документы в формате HTML, но могут быть экспортированы в документ HTML. Экспорт рисунков в виде веб-страниц из Draw похож на экспорт презентации из Impress. Выберите пункт меню :menuselection:`Файл --> Экспорт` и выберите тип файла *Документ HTML (Draw)*, а затем следуйте процедуре, описанной выше для экспорта презентации из Impress.
