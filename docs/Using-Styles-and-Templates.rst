.. meta::
   :description: Краткое руководство по LibreOffice: Глава 3 – Использование Стилей и Шаблонов
   :keywords: LibreOffice, Writer, Impress, Calc, Math, Base, Draw, либреоффис

.. Список автозамен

.. |br| raw:: html

   <br />


.. _using-styles-and-templates

Глава 3 – Использование Стилей и Шаблонов
=========================================

Что такое шаблоны?
------------------

Шаблон это типовой документ, который используется для создания других документов. Шаблон аналогичен стандартному бланку. Например, можно создать шаблон делового отчета, который будет содержать логотип компании.  Новые документы, созданные из такого шаблона, будет уже содержать логотип компании.

Шаблоны могут содержать в структуре документа текст, таблицы, графику, установленные стили, информацию пользователя такую, как  единицы измерения, язык, принтер по умолчанию и настройки меню и панелей инструментов.

Все компоненты LibreOffice поддерживают шаблоны. Можно создать отдельные шаблоны для любых типов документов (текст, электронные таблицы, рисунки, презентации). Если при создании нового документа не выбрать какой-либо специальный шаблон, то он будет основан на стандартном шаблоне по умолчанию. Если не указан шаблон по умолчанию, то LibreOffice использует чистый лист для этого типа документа LibreOffice. Подробнее смотрите раздел `Установка шаблона по умолчанию`_.

По умолчанию LibreOffice может не содержать стандартных шаблонов. При необходимости можно скачать готовые шаблоны из интернета или  создать собственные шаблоны. Официальный репозиторий шаблонов LibreOffice находится на сайте http://templates.libreoffice.org/. Также подборку русскоязычных шаблонов можно найти на сайте http://myooo.ru/content/blogsection/15/99.

Шаблоны, наряду со стилями, составляют одну из основных концепций LibreOffice.

Что такое стили?
------------------

Стиль ― совокупность правил(настроек) оформления текста, таблиц, врезок и страниц. Стили содержат целую группу настроек форматирования и позволяют быстро применить заданное форматирование к объектам в документе. 

Большинство пользователей форматируют абзацы, слова, таблицы, разметку страниц и другие части документа без использования стилей. Таким образом, они создают документы в соответствии с физическими атрибутами. Например, заголовки выделяются полужирным начертанием.

Стили являются логическими атрибутами. Это означает, что необходимо перестать мыслить категориями: размер шрифта 14pt, Times New Roman, жирный, расположение по центру и др. Необходимо перейти на структурное мышление и начать воспринимать текст как совокупность заголовков (1-го, 2-го, n-го уровня), абзацев основного текста и т.д. Другими словами, надо отвлечься от внешнего оформления и сосредоточиться на структуре текста. Так, например, к заголовку необходимо применять стиль *Заголовок*, которому присвоены различные характеристики (начертание, размер шрифта, отступы).

Стили помогают сконцентрироваться на документе. Они также делают значительно проще процесс изменения форматирования. Например, если необходимо изменить отступ всех абзацев или шрифт для всех заголовков (или для заголовков определенного уровня). Для большого документа эта простая задача может стать большой проблемой, если решать ее вручную. Применение стилей делает задачу легко решаемой.

Кроме того, стили используются в LibreOffice для многих других функций, например, Writer формирует оглавление опираясь на стили типа «Заголовок». Некоторые общие примеры использования стилей приведены в разделе `Примеры использования стилей`_.

LibreOffice поддерживает следующие типы стилей:

**Writer:**

* Стили страницы - задают оформление полей, колонтитулов, обрамление, разбиение на колонки и фон.

* Стили абзаца содержат настройки абзацев(заголовков): гарнитуру, кегль, междустрочный интервал (интерлиньяж), отступ первой строки, отступы слева и справа и другие.

* Стили символа включают настройки отдельных символов внутри абзаца (гарнитура, кегль, эффекты шрифта). Данный стиль может быть применен как к отдельному символу в абзаце, так и к целому слово или группе слов.

* Стили врезок используются для форматирования графических и текстовых врезок, включая переходы на новую строку, границы, фон и полосы.

* Стили списка определяют выравнивание, тип нумерации или маркеров, и шрифты для нумерованных и ненумерованных списков. Сами по себе они не используются. Стили списка применяются к стилям абзаца в диалоге создания и редактирования стиля абзаца на вкладке «Структура и нумерация». 

**Calc:**

* Стили ячейки в электронных таблицах Calc относятся к шрифтам, выравниванию, границам, фону, форматам чисел (например, валюта, дата, номер) и защите ячеек.

* Cтили страницы содержат параметры вывода листов на печать или экспорта в PDF.

**Impress и Draw:**

* Стили рисунков относятся к линиям, областям, теням, прозрачности, шрифту, соединителям, размерам и другим атрибутам.

* Стили презентации определяют атрибуты шрифта, отступов, расстояний, выравнивания и табуляции.

Base и Math не содержат собственные стили, однако к объектам из Base и Math могут применяться стили тех модулей, в которые они вставлены. Например, к формулам могут быть применены стили врезок Writer.

LibreOffice содержит большое количество готовых стилей. Можно использовать стандартные стили, изменять их или создавать новые стили, как это описано в данной главе.

В различных компонентах доступны различные наборы стилей. 

.. csv-table:: 
    :header: "Тип стиля", "Writer", "Calc", "Impress", "Draw"
    :widths: 5,3,3,3,10
    
    Страница,x,x,,
    Абзац,x,,,
    Символ,x,,,
    Врезка,x,,,
    Нумерованный список,x,,,
    Ячейка,,x,,
    Презентация,,,x,x
    Графика,(включены в стилях врезок),,x,x


Применение стилей
-----------------

LibreOffice предоставляет несколько способов выбора стилей для применения.

Использование диалога Стили и форматирование
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. Нажмите на значок *Стили*, расположенной с левого края панели форматирования или выберите пункт меню :menuselection:`Фо&рмат --> Сти&ли` или нажмите клавишу ``F11`` на клавиатуре. 

.. _ch3-lo-screen-002:

.. figure:: _static/chapter3/ch3-lo-screen-002.png
    :scale: 70%
    :align: center
    :alt: Значок Стили на панели форматирования
    
    Значок *Стили* на панели форматирования

Окно *Стили и форматирование* отображает доступные для использования в текущем компоненте LibreOffice типы стилей. На рисунке ниже показан диалог *Стили и форматирование* для Writer с открытой вкладкой *Стили абзаца*. Данное окно можно передвинуть в любое место на экране или прикрепить к краю экрана.
 
.. _ch3-lo-screen-001:

.. figure:: _static/chapter3/ch3-lo-screen-001.png
    :scale: 70%
    :align: center
    :alt: Окно Стили и форматирование компонента Writer
    
    Окно *Стили и форматирование* компонента Writer

2. Нажмите на один из значков (вкладку) в верхней части окна *Стили и форматирование*, чтобы отобразить список стилей в той или иной категории.

3. Чтобы применить существующий стиль, поместите курсор в абзаце, врезке, странице или слове, а затем дважды нажмите на название стиля в одном из этих списков. Чтобы применить стиль символов для более чем одного слова, сначала выберите необходимые символы, зажав клавишу ``Ctrl``, затем выберите необходимый стиль символа.

.. note:: В нижней части окна *Стили и форматирование* есть выпадающий список. Он позволяет сортировать списки стилей, отображаемые в окне. Можно выбрать отображение всех стилей или группы стилей, например, только пользовательских стилей. Очень удобен фильтр *По иерархии*.

Использование стилевой заливки
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Используйте стилевую заливку, чтобы применить стиль к нескольким различным областям, без необходимости каждый раз возвращаться к окну *Стили и форматирование*. Этот метод является весьма полезным, если необходимо отформатировать много разбросанных по тексту абзацев, ячеек или других элементов с единым стилем.

1. Откройте окно *Стили и форматирование* и выберите стиль, который необходимо применить.

2. Нажмите на значок *Стилевая заливка* |ch3-lo-screen-003|.

.. |ch3-lo-screen-003| image:: _static/chapter3/ch3-lo-screen-003.png
        :scale: 80% 

3. Чтобы применить стиль к абзацу, странице или врезке, установите курсор мыши на абзац, страницу или врезку и нажмите левую кнопку мыши. Чтобы применить стиль символа, удерживайте левую кнопку мыши, выбирая символы. Нажатие кнопкой мыши на слове применяет стиль символа к слову.

4. Чтобы выйти из режима *Стилевая заливка*, нажмите на значок *Стилевая заливка* еще раз или нажмите клавишу ``Esc`` на клавиатуре.

.. warning:: Когда режим *Стилевая заливка* активен, то нажатия на правую кнопку мыши отменяют последние изменения. Будьте осторожны, чтобы случайно не нажать правую кнопку мыши, отменив при этом действия, которые требовалось сохранить.


Использование списка Используемые стили
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

После того, как стиль хотя бы раз использован в документе, его название появляется в списке *Используемые стили*, расположенном в левой части панели форматирования, рядом со значком *Стили*. Можно открыть данный список и нажать левой кнопкой мыши на одном из стилей. Также можно пролистывать список клавишами со стрелками вверх и вниз, а выбор необходимого стиля осуществлять нажатием клавишей ``Enter``.

.. _ch3-lo-screen-004:

.. figure:: _static/chapter3/ch3-lo-screen-004.png
    :scale: 70%
    :align: center
    :alt: Список Используемые стили на панели форматирования
    
    Список *Используемые стили* на панели форматирования

.. note:: Выберите пункт *Еще...* внизу списка, чтобы открыть окно *Стили и форматирование*.


Использование клавиатурных сочетаний клавиш
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Некоторые сочетания клавиш предопределены для применения стилей. Например, в компоненте Writer сочетание клавиш ``Ctrl+0`` применяет стиль *Основной текст*, ``Ctrl+1`` применяет стиль *Заголовок 1* и  ``Ctrl+2`` применяет стиль *Заголовок 2*. Вы можете изменять эти сочетания и задать свои. Смотрите раздел :ref:`assigning-shortcut-keys` для получения дополнительной информации.

.. warning:: Форматирование вручную (также называемое прямое форматирование) отменяет стили и вы не сможете избавиться от ручного форматирования, применяя к элементу стиль.

 Чтобы удалить ручное форматирование, выделите текст, нажмите по нему правой кнопкой мыши и выберите пункт *Очистить форматирование* из контекстного меню или нажмите ``Ctrl+M`` после выделения текста.

-------------

Изменение стилей
----------------

В LibreOffice есть несколько возможностей изменить стили:

* Изменение стиля с помощью диалога *Стиль*;
* Обновление стиля из выделенного;
* Использование *Автообновления* (только стили абзаца и врезок);
* Загрузка или копирование стиля из другого документа или шаблона.

.. note:: Все изменения стилей остаются только в текущем документе. Чтобы изменить стили в нескольких документах, необходимо изменить стили в шаблоне или импортировать стили в другие документы, как это описано в разделе `Копирование стиля из шаблона или документа`_

Изменение стиля с помощью диалога Стиль
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы изменить существующий стиль используя диалог *Стиль*, нажмите правой кнопкой мыши на нужном стиле в окне *Стили и форматирование* и выберите в выпавшем контекстного меню пункт *Изменить*.

Диалог *Стиль* отображается в зависимости от выбранного типа стиля. Каждый диалог стиля имеет несколько вкладок. Смотрите главы, посвященные стилям, в  полных руководствах по компонентам LibreOffice.

Обновление стиля из выделенного
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы обновить стиль из выделенного:

1. Откройте окно *Стили и форматирование*.
2. В документе выберите элемент, имеющий необходимое форматирование, которое необходимо принять в качестве стиля.
3. В диалоге *Стили и форматирование* выберите стиль, который необходимо обновить (одним нажатием, не двумя!), затем нажмите на значок рядом со значком *Новый стиль* и выберите пункт *Обновить стиль по образцу*.

.. _ch3-lo-screen-005:

.. figure:: _static/chapter3/ch3-lo-screen-005.png
    :scale: 70%
    :align: center
    :alt: Обновление стиля из выделенного
    
    Обновление стиля из выделенного

.. warning:: Убедитесь, что форматирование абзаца не имеет противоречивых параметров. Например, абзац не должен содержать шрифтов с разным размером или гарнитурой, иначе обновление по образцу ни приведет к желаемому результату.

Использование Автообновления
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Автообновление применяется только к стилям абзаца и врезок. Если функция *Автообновление* активирована на вкладке *Управление* в окне настроек выбранного стиля абзаца или врезки (нажмите правой кнопкой мыши по нужному стилю и выберите *Изменить*), то применяя ручное форматирование к этому абзацу или врезке, вы автоматически обновите сам стиль.

.. tip:: Если у вас есть привычка менять стили вручную в ваших документах, убедитесь, что функция автообновления отключена.

Обновление стилей из документа или шаблона
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Можно обновить стили копированием или загрузкой их из шаблона или иного документа. Смотрите раздел `Копирование стиля из шаблона или документа`_.

------------

Создание нового (пользовательского) стиля
------------------------------------------

LibreOffice позволяет создавать новые стили. Сделать это можно двумя способами:

* Создать новый стиль, используя диалог *Стиль*;
* Создать новый стиль из выделенного фрагмента текста.

Создание нового стиля, используя диалог Стиль
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы создать новый стиль, используя диалог *Стиль*, нажмите правой кнопкой мыши в окне *Стили и форматирование* и выберите *Создать...* в появившемся меню.

Если вы хотите, чтобы новый стиль был связан с существующим стилем, то сначала выделите этот стиль (один раз нажмите левой кнопкой мыши на название стиля), затем нажмите правой кнопкой мыши и выберите пункт *Создать*.

При связывании стилей, изменения базового стиля (например, изменение шрифта DeJaVu на PT Sans) повлекут за собой изменения всех связанных с ним стилей. В большинстве случаев это удобно, но иногда может создавать проблемы. Стоит продумывать это заранее.

Диалоги и выбор одинаковы как для создания нового стиля, так и для изменения существующего стиля. Для получения более подробной информации смотрите главы посвященные стилям в полных руководствах пользователя.

Создание нового стиля из выделенного фрагмента текста
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Можно создавать новые стили на основе оформленных фрагментов текста.

1. Откройте окно *Стили и форматирование* и выберите тип стиля, который необходимо создать.
2. В документе выделите фрагмент текста или объект (врезка, изображение, рисунок), параметры которого вы хотите сохранить в стиль.
3. В окне *Стили и форматирование* нажмите на значок *Создать стиль из выделенного* в правом верхнем углу.
4. В диалоге *Создать стиль* введите имя для нового стиля. В списке отображаются названия ранее созданных стилей. Нажмите кнопку *OK* для сохранения нового стиля.

.. _ch3-lo-screen-006:

.. figure:: _static/chapter3/ch3-lo-screen-006.png
    :scale: 70%
    :align: center
    :alt: Ввод имени нового стиля, созданного из выделенного фрагмента
    
    Ввод имени нового стиля, созданного из выделенного фрагмента


Перетаскивание элемента для создания стиля
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Вы можете перетащить выделенный элемент в окно *Стили и форматирование*, чтобы создать новый стиль. Варианты создания стилей таким методом для разных компонентов LibreOffice перечислены ниже:

**Writer**

Выберите часть текста и перетащите его в диалог *Стили и форматирование*. *Тип* создаваемого стиля будет зависеть от активного типа стиля в окне *Стили и форматирование*. Если в окне активен стиль абзаца, то в список будет добавлен новый стиль абзаца. Если активен стиль символов, то добавлен будет новый стиль символов.

**Calc**

Перетащите выбранную ячейку в диалог *Стили и форматирование*, чтобы создать новый стиль ячейки.

**Draw / Impress**

Выберите и перетащите графический объект в диалог *Стили и форматирование*, чтобы создать новый стиль графики.

-------

Копирование стиля из шаблона или документа
-------------------------------------------

Созданные стили остаются в текущем документе. Чтобы использовать ранее созданные стили в новом документе, их можно загрузить  из шаблона или из другого документа:

1. Откройте документ, в который вы хотите скопировать стиль.
2. В окне *Стили и форматирование* нажмите стрелочку рядом со значком *Создать стиль из выделенного* и выберите *Загрузить стили* (смотрите рисунок :ref:`ch3-lo-screen-005`).
3. Выберите категорию стилей для копирования. Выберите опцию *Заменить*, если вы хотите заменить стили с такими же именами в документе, куда копируете стили.
4. В диалоге *Загрузить стили*:

    * Чтобы копировать стили из шаблона, найдите и выберите шаблон. 
    * Чтобы копировать стили из других документов, нажмите кнопку *Из файла...*. Откроется окно, в котором вы сможете найти и выбрать необходимый документ.
5. Нажмите кнопку *OK*, чтобы скопировать стили.

.. _ch3-lo-screen-007:

.. figure:: _static/chapter3/ch3-lo-screen-007.png
    :scale: 60%
    :align: center
    :alt: Копирование стилей из шаблона в открытый документ
    
    Копирование стилей из шаблона в открытый документ

.. warning:: Если в вашем документе есть оглавление, созданное на основе пользовательских стилей типа *Заголовок*, связанных со структурой из меню :menuselection:`С&ервис --> &Структура нумерации`, то при загрузке стилей структура вернется к значениям по умолчанию типа *Заголовок 1*, *Заголовок 2* и так далее. Вам нужно будет после загрузки стилей, поменять стили заголовков обратно на пользовательские.

.. note:: На рисунке :ref:`ch3-lo-screen-007` показан маркер *Кадр* (может также называться *Фрейм*). В данном случае, это ошибка перевода, так как имеется ввиду стиль врезок. В последующих выпусках LibreOffice данная ошибка должна быть исправлена.

Удаление стилей
-------------------------------------------

Невозможно удалить любые предустановленные в LibreOffice стили из документа или шаблона, даже если они не используются.  Можно удалить любые пользовательские стили, но прежде чем  это сделать, необходимо убедиться, что выбранные стили не используются в текущем документе. Если нежелательный стиль используется, то его нужно будет заменить его другим стилем.

Чтобы удалить ненужный стиль, нажмите правой кнопкой мыши на нем в окне *Стили и форматирование* и выберите пункт *Удалить* в контекстном меню.  Если стиль не используется, то он будет удален. Если стиль используется, то будет выведено окно с предупреждением об этом и предложением подтвердить удаление.

.. warning:: Убедитесь перед удалением, что стиль не используется. Иначе все объекты с этим стилем будут возвращены к стилю по умолчанию и форматирование элемента сохранится, как ручное.

---------------

Использование шаблона для создания документа
--------------------------------------------

Чтобы использовать шаблон для создания документа:

1. В главном меню выберите :menuselection:`&Файл --> &Создать --> &Шаблоны`. Откроется диалог *Менеджер шаблонов*.
2. Из вкладок в верхней части диалога выберите категорию (тип документа) шаблона, который вы хотите использовать. Папки, содержащие шаблоны, показаны на каждой странице категорий диалога. Если папки не видны, значит в настоящий момент нет доступных шаблонов.
3. Дважды нажмите левой кнопкой мыши на папку, содержащую шаблон, который вы хотите использовать. Все шаблоны, содержащиеся в папке будут показаны на сранице.
4. Выберите шаблон, который хотите использовать. 
5. Дважды нажмите на выбранном шаблоне. Новый документ, основанный на выбранном шаблоне откроется в LibreOffice.

.. _ch3-lo-screen-008:

.. figure:: _static/chapter3/ch3-lo-screen-008.png
    :scale: 50%
    :align: center
    :alt: Диалог Менеджера шаблонов
    
    Диалог Менеджера шаблонов

Создание шаблона
--------------------------------------------

Создавать новые шаблоны можно двумя способами:

* Сохранив текущий документ как шаблон;
* Используя *Мастер*.

Создание шаблона из документа
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Для создания шаблона из документа и сохранения его в папку *Мои шаблоны*:

1. Откройте новый или существующий документ того типа, которого вы хотите создать шаблон (текстовый документ, электронную таблицу, рисунок или презентацию).
2. Добавьте содержимое и стили, которые вы хотите.
3. В главном меню выберите :menuselection:`&Файл --> &Шаблоны --> &Сохранить как шаблон`. Откроется диалог *Менеджер шаблонов* на вкладке *Документы*.
4. Если папка *Мои шаблоны* видимая, выберите её. Если нет, то в верхней части окна из вкладок выберите категорию, в которой папка видна и выберите её.

.. note:: Не имеет значения, какая вкладка выбрана в настоящий момент. Необходимо найти и выбрать папку *Мои шаблоны*. Шаблон будет автоматически сохранен в папке *Мои шаблоны* на правильной вкладке в соответствии с метаданными, содержащимися в самом файле.
Чтобы узнать больше о папках шаблонов, смотрите раздел `Управление шаблонами`_.

5. Нажмите кнопку *Сохранить*.
6. Откроется диалог, введите имя шаблона и нажмите *ОК*. Вы можете просмотреть папку *Мои шаблоны*, чтобы убедиться, что шаблон расположен на правильной вкладке.
7. Закройте диалог *Менеджер шаблонов*.

.. _ch3-lo-screen-009:

.. figure:: _static/chapter3/ch3-lo-screen-009.png
    :scale: 50%
    :align: center
    :alt: Сохранение нового шаблона
    
    Сохранение нового шаблона

Любые настройки, которые могут быть добавлены или изменены в документе, можно сохранить в шаблоне. Например, ниже показаны некоторые (далеко не весь перечень) настроек, которые могут быть включены в документ Writer и сохранены в шаблоне для дальнейшего использования:

* Настройки печати: принтер, одно- или двухсторонняя печать, размер бумаги, и тому подобное.
* Стили, которые будут использоваться, включая стили символов, страницы, врезки, списков и абзацев.
* Формат и параметры, касающиеся индексов, таблиц, библиографий, оглавления.

Шаблоны могут также содержать заранее введенный текст, избавляя от необходимости вводить его каждый раз при создании нового документа. Например, шаблон письма может содержать ваше имя, адрес и приветствие.

В шаблоне также можно сохранить настройки меню и панелей инструментов. Смотрите :ref:`Customizing-LibreOffice`, для получения дополнительной информации.


Обновление документа из изменённого шаблона
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Для создания шаблонов писем, факсов, повесток дня, презентаций и веб-страниц можно использовать *Мастер*. Например, мастер создания факсов проведет через следующие шаги:

* Тип факса (деловой или персональный);
* Элементы документа такие, как дата, адресат, приветствие и подпись;
* Настройки для отправки и получения (деловой факс);
* Текст, включаемый в нижний колонтитул (деловой факс).

Чтобы создать шаблон, используя мастер:

1. Выберите из главного меню :menuselection:`&Файл --> &Мастер --> [нужный тип шаблона]`.
2. Следуйте инструкциям на страницах мастера. Этот процесс отличается для каждого типа шаблона, но формат очень похож.
3. В последней секции мастера, вы можете указать имя шаблона, которое будет отображаться в менеджере шаблонов и имя и расположение для сохраняемого файла шаблона. Желательно давать одинаковые имена во избежание путаницы. По умолчанию файлы шаблонов сохраняются в системный каталог шаблонов пользователя, но вы можете выбрать любой другой.
4. Нажмите кнопку выбора пути, чтобы установить имя файла и указать путь до файла. Укажите имя файла и нажмите кнопку *Сохранить*, чтобы закрыть диалог.
5. Наконец, у вас есть возможность создать новый документ из подготовленного шаблона или внести изменения в шаблон после нажатия кнопки *Завершить*. Для будущих документов вы можете пересоздать шаблон с помощью мастера.

Вам придется открыть менеджер шаблонов и нажать кнопку *Обновить* в *Меню действий*, чтобы отобразить все новые добавленные шаблоны.

.. note:: В этом выпуске LibreOffice, нажатие кнопки *Завершить* заново откроет диалог сохранения файла, который открывался в шаге 4. Нажмите в диалоге кнопку *Сохранить*, файл будет записан на жесткий диск. 

 Нажатие кнопки *Сохранить* в шаге 4 сохраняет данные в оперативной памяти и не сохраняет файл на жесткий диск.


Редактирование шаблона
--------------------------------------------

Можно отредактировать в шаблоне стили и содержимое, а также применить изменённые в шаблоне стили к документам, которые были созданы на его основе. (Обратите внимание, что изменятся только стили, но не содержимое документа).

Чтобы отредактировать шаблон:

1. Выберите в главном меню :menuselection:`Файл --> Создать --> Шаблоны`. Откроется *Менеджер шаблонов*.
2. Найдите шаблон, который необходимо изменить. Нажмите по нему один раз, чтобы выбрать его. В верхней части окна нажмите кнопку *Правка*. Шаблон откроется в LibreOffice.
3. Измените шаблон так же, как и любой другой документ. Чтобы сохранить изменения выберите в главном меню пункт :menuselection:`Файл --> Сохранить`.


Обновление документа из изменённого шаблона
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

При новом открытии документа, который был создан на основе измененного шаблоны до его изменения, вы увидите следующее сообщение:

.. _ch3-lo-screen-010:

.. figure:: _static/chapter3/ch3-lo-screen-010.png
    :scale: 70%
    :align: center
    :alt: Сообщение об обновлении стилей
    
    Сообщение об обновлении стилей

Нажмите *Обновить стили*, чтобы применить измененные стили из шаблона к документу.  Нажмите *Сохранить старые стили*, если вы не хотите применять измененные стили из шаблона к документу.

.. warning:: Если вы выберите *Сохранить старые стили* в сообщении, показанном на рисунке выше, то это сообщение больше не будет показываться вам никогда при открытии этого документа, даже если вы снова поменяете шаблон, на котором он был основан. Вы больше не сможете обновить стили из шаблона для этого документа штатными средствами, но при этом вы можете использовать макрос из примечания ниже для активирования этой возможности.

.. note:: Чтобы вновь получить возможность обновлять стили из шаблона:
 1. используйте :menuselection:`Сервис --> Макросы --> Управление макросами --> LibreOffice Basic`. Выберите документ из списка, нажмите на значке раскрытия списка (+ или треугольник) и выберите *Standard*. Если *Standard* имеет рядом значок раскрытия (+ или треугольник), то нажмите на его и выберите модуль.
 2. Если кнопка *Правка* активна, нажмите её. Если кнопка *Правка* неактивна, то нажмите *Создать*.
 3. В окне Basic введите следующее:
 
 .. code-block:: basic
 
    Sub FixDocV3 
    ' set UpdateFromTemplate 
     oDocSettings = ThisComponent.createInstance( _ 
      "com.sun.star.document.Settings" ) 
     oDocSettings.UpdateFromTemplate = True 
    End Sub 'FixDocV3
    
 4. Нажмите значок *Run BASIC* чтобы закрыть окно *Basic*.
 5. Сохраните документ.

 При следующем открытии документа вы увидите предупреждение об изменении стилей в шаблоне.


-----------

Добавление шаблонов, полученных из других источников
----------------------------------------------------

Вы можете скачать шаблоны для LibreOffice из множества источников, включая официальный репозиторий по адресу http://templates.libreoffice.org/, и установить их на ваш компьютер. На дургих сайтах вы можете найти коллекции шаблонов, запакованных в файлы с расширением ``.OXT``. Они устанавливаются несколько иначе и об этом сказано ниже.

Установка индивидуальных шаблонов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы установить индивидуальные шаблоны:

1. Скачайте шаблон и сохраните его на вашем компьютере.
2. Импорт шаблона в папку с шаблонами описан в инструкции в разделе `Импорт шаблонов`_.

.. tip:: (Для продвинутых пользователей) Если вы знаете расположение папки с шаблонами LibreOffice, то вы можете вручную скопировать новый шаблон в неё. Расположение варьируется в зависимости от операционной системы на вашем компьютере. Чтобы узнать, где расположены папки с шаблонами на вашем компьютере посмотрите в меню :menuselection:`С&ервис --> &Параметры --> LibreOffice --> Пути`.

Установка коллекций шаблонов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Менеджер расширений позволяет легко устанавливать коллекции шаблонов, которые упакованы, как расширения. Выполните следующее:

1. Скачайте расширение (файл ``.oxt``) и сохраните его на вашем компьютере.
2. В LibreOffice выберите в главном меню :menuselection:`Сервис --> Управление расширениями`. В диалоге менеджера расширений  нажмите кнопку *Добавить*, чтобы открыть окно обозревателя файлов.
3. Найдите и выберите пакет шаблонов, который вы хотите установить и нажмите кнопку *Открыть*. Пакет будет установлен. Возможно вас попросят принять лицензию.
4) После завершения установки пакета шаблонов, они будут доступны из меню :menuselection:`Файл --> Создать --> Шаблоны` и, как расширение, в списке менеджера расширений.

Смотрите :ref:`Customizing-LibreOffice` для получения более подробной информации об установке расширений.


Установка шаблона по умолчанию
----------------------------------------------------

Если вы создаете документ выбирая пункт меню :menuselection:`Файл --> Создать --> Текстовый документ` (или Электронную таблицу, Презентацию или Рисунок), LibreOffice создаст документ из шаблона по умолчанию для данного типа документа. Можно изменить стандартный пользовательский шаблон. В дальнейшем можно сбросить значение по умолчанию.

.. note:: Для Windows-пользователей. Microsoft Word использует файл ``normal.dot`` или ``normal.dotx`` в качестве шаблона по умолчанию. LibreOffice не содержит аналогичного файла шаблона по умолчанию. «Заводские настройки» встроены в программу. 

Установка пользовательского шаблона по умолчанию
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Вы можете установить любой шаблон в качестве шаблона «по умолчанию», если он находится в любой папке в менеджере шаблонов.

Чтобы установить пользовательский шаблон по умолчанию:

1. Выберите в главном меню :menuselection:`Файл --> Создать --> Шаблоны`.
2. В диалоге менеджера шаблонов откройте папку, содержащую тот шаблон, который вы хотите задать по умолчанию и выберите шаблон.
3. Нажмите кнопку *Сделать основным* вверху списка шаблонов.

.. _ch3-lo-screen-011:

.. figure:: _static/chapter3/ch3-lo-screen-011.png
    :scale: 50%
    :align: center
    :alt: Установка пользовательского шаблона по умолчанию
    
    Установка пользовательского шаблона по умолчанию

В последующем при создании нового документа, он будет создан из этого шаблона.

Сброс шаблона по умолчанию к «заводским настройкам»
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы восстановить изначальное значение в LibreOffice шаблона по умолчанию для типов документа:

1. В менеджере шаблонов нажмите значок *Меню действий* в правом верхнем углу.
2. Наведите курсор мыши на пункт *Восстановить шаблон по умолчанию* и нажмите на пункте *Текстовый документ* (или другой тип шаблона).

Эти пункты не появляются в меню, если шаблон по умолчанию не изменялся. В последующем при создании документа из меню :menuselection:`Файл --> Создать`, документ будет создан из шаблона по умолчанию для данного типа документа.

.. _ch3-lo-screen-011a:

.. figure:: _static/chapter3/ch3-lo-screen-011a.png
    :scale: 50%
    :align: center
    :alt: Восстановление шаблона по умолчанию для текстового документа
    
    Восстановление шаблона по умолчанию для текстового документа

Связывание документа с другим шаблоном
----------------------------------------------------



Управление шаблонами
----------------------------------------------------

В LibreOffice можно использовать шаблоны, которые находятся в папках шаблонов  LibreOffice. Вы можете создать новые папки шаблонов в LibreOffice и использовать их для управления вашими шаблонами. Например, вы можете иметь папку с шаблонами для писем и папку с шаблонами для отчетов. Вы также можете импортировать и экспортировать шаблоны.

Для начала выберите пункт :menuselection:`Файл --> Создать --> Шаблоны`, чтобы открыть диалог менеджер шаблонов.

.. _ch3-lo-screen-012:

.. figure:: _static/chapter3/ch3-lo-screen-012.png
    :scale: 60%
    :align: center
    :alt: Значки действий с шаблонами
    
    Значки действий с шаблонами

Создание папки шаблонов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы создать папку шаблонов:

1. В менеджере шаблонов нажмите на кнопку *Все шаблоны* и затем кнопку *Новая папка* или дважды нажмите на любую папку,  выберите в ней любой шаблон, чтобы открылись значки действий в верхней части диалога. Затем нажмите кнопку *Переместить в папку* и выберите пункт *Новая папка*.
2. В появившемся окне введите имя для новой папки и нажмите *ОК*.


Удаление папки шаблонов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Вы не сможете удалить папки шаблонов, которые были установлены с LibreOffice или те, которые были установлены через менеджер расширений. Вы можете удалять только те папки, которые создали сами вручную.

Чтобы удалить папку шаблонов:

1. В менеджере шаблонов выберите папку, которую хотите удалить.
2. В строке значков над папками нажмите кнопку *Удалить*. Появится сообщение с запросом подтверждения удаления. Нажмите *Да*.


Перемещение шаблонов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы переместить шаблон из одной папки в другую:

1. В менеджере шаблонов дважды нажмите на папку, где находится шаблон, который вы хотите переместить.
2. Выберите нужный шаблон и в появившейся строке значков сверху выберите *Переместить в папку*.



Удаление шаблонов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Невозможно удалить шаблоны, которые были установлены с LibreOffice или те, которые были установлены через менеджер расширений. Можно удалять только те шаблоны, которые созданы пользователем вручную или импортированы. 

Чтобы удалить шаблон:

1. В менеджере шаблонов дважды нажмите на папку, где находится шаблон, который необходимо удалить.
2. Выберите нужный шаблон, который необходимо удалить.
3. В появившейся строке значков сверху выберите *Удалить*. Появится сообщение с запросом подтверждения удаления. Нажмите *Да*.

Импорт шаблонов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы использовать шаблон в LibreOffice, то его необходимо поместить в папку шаблонов LibreOffice. Для этого:

1. В менеджере шаблонов выберите папку, в которую хотите поместить шаблон.
2. Нажмите кнопку *Импорт* сверху от списка папок. Откроется стандартное окно обзора файлов.
3. Найдите и выберите нужный шаблон и нажмите *Открыть*. Окно обзора файлов закроется и шаблон добавится в выделенную папку.

Экспорт шаблонов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы экспортировать шаблон в другое место из папки шаблонов:

1. В менеджере шаблонов дважды нажмите на папку, где находится шаблон, который вы хотите экспортировать.
2. Выберите нужный шаблон, который хотите экспортировать.
3. Нажмите кнопку *Экспорт* сверху от списка папок. Откроется стандартное окно *Сохранить как...*.
4. Найдите нужный каталог, в который необходимо экспортировать шаблон, войдите в него и нажмите *Сохранить*.

----------------

Примеры использования стилей
----------------------------------------------------

Следующие примеры использования стилей страниц и абзацев взяты из Writer. Есть много других способов использования стилей. Для получения более подробной информации смотрите полные руководства для соответствующих компонентов LibreOffice .

Назначение отличающейся первой страницы в документе
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Многие документы, такие как письма и отчеты, имеют первую страницу, которая отличается от других страниц документа. Например, первая страница фирменного бланка имеет другой заголовок или первая страница отчета не имеет верхнего колонтитула в отличие от последующих страниц. В LibreOffice можно определить применяемые автоматически стиль для первой страницы и указать стиль для последующих страниц.

Как пример, можно использовать стиль страницы *Первая страница* и стиль страницы *По умолчанию*, встроенные в LibreOffice. На рисунке ниже показано схематично, что необходимо сделать: стиль *Первая страница*, за ней идет страница со стилем *По умолчанию* и все последующие страницы будут иметь стиль *По умолчанию*. Детали изложены в *Главе 4 Форматирование страниц*, в полном руководстве по Writer.

.. _ch3-lo-screen-013:

.. figure:: _static/chapter3/ch3-lo-screen-013.png
    :scale: 70%
    :align: center
    :alt: Порядок следования стилей страниц
    
    Порядок следования стилей страниц

Разделение документа на главы
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Аналогичным образом можно разделить документ на главы. Каждая глава может начинаться со стилем страницы *Первая страница* с последующими стилями для страниц *По умолчанию*, как указано выше. В конце главы вставьте разрыв страницы и задайте следующей странице стиль *Первая страница*, чтобы начать новую главу, как показано на рисунке ниже.

.. _ch3-lo-screen-014:

.. figure:: _static/chapter3/ch3-lo-screen-014.png
    :scale: 70%
    :align: center
    :alt: Разделение документа на главы, используя стили страниц
    
    Разделение документа на главы, используя стили страниц
    
Изменение ориентации страницы в документе
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Документ Writer может содержать страницы в более, чем одной ориентации. Обычно требуется создать страницу в  ландшафтной ориентации посереди страниц в портретной ориентации. Этого также можно добиться, используя разрывы страницы и стили страницы.

Различающиеся заголовки на правой и левой страницах
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Стили страниц можно настроить так, чтобы левая и правая страница были зеркальными друг другу или страницы были только правыми (первые страницы глав обычно только правые) или только левыми. При вставке заголовка в стиль страницы, созданный для зеркальных страниц или правой и левой страниц, вы можете получить одинаковый заголовок для всех страниц или отличающийся заголовок для правой и левой страницы. Например, вы можете поместить номер страницы в правом углу для правой страницы и в левом для левой, поставить название документа только на правой странице или внести другие изменения. 

Автоматический контроль разрывов страниц
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

В книгах часто названия глав начинаются с новой страницы. Подобное поведение можно организовать автоматически, задав разрыв страницы перед абзацев в стилю заголовка главы. Разрыв страницы задается в свойствах стиля абзаца на вкладке *Положение на странице* в разделе *Разрывы*.

.. _ch3-lo-screen-015:

.. figure:: _static/chapter3/ch3-lo-screen-015.png
    :scale: 50%
    :align: center
    :alt: Добавление разрыва страницы в свойствах стиля
    
    Добавление разрыва страницы в свойствах стиля

Составление автоматического оглавления
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы создать автоматическое оглавление, первым делом нужно применить ко всем нужным заголовкам стили типа *Заголовок*, чтобы они могли появиться в оглавлении. А затем использовать пункт меню :menuselection:`Вст&авка --> &Оглавление и указатели --> &Оглавление и указатели...`, чтобы указать Writer, какие стили и уровни нужно использовать для создания оглавления. Смотрите Главу 4 для получения более подробной информации.

Определение последовательности стилей
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Стили абзаца можно настраивать так, чтобы при нажатии на клавишу ``Enter`` в конце абзаца, к следующему абзацу автоматически был применен заранее заданный стиль. Например, можно определить стиль абзаца *Заголовок 1*, за которым будет следовать абзац со стилем *Основной текст*. Более сложный пример будет выглядеть так (по стилям): *Название*, за которым следует *Автор*, за которым следует *Аннотация*, за которым следует *Заголовок 1*, за которым следует *Основной текст*. Установив такие последовательности, можно в большинстве случаев избежать применения стилей вручную.
