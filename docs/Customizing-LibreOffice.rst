
.. meta::
   :description: Краткое руководство по LibreOffice: Глава 14 – Дополнительная настройка LibreOffice
   :keywords: LibreOffice, Writer, Impress, Calc, Math, Base, Draw, либреоффис, Предисловие


.. _Customizing-LibreOffice:

Глава 14 – Дополнительная настройка LibreOffice
===============================================

Эта глава описывает некоторые дополнительные настройки LibreOffice.

Можно настраивать под себя меню, панели инструментов и сочетания клавиш LibreOffice, добавлять новые меню и панели инструментов и назначить макросы на события. При этом контекстные меню настраивать нельзя.

Множество других настроек можно легко сделать при помощи расширений, которые можно установить с сайта LibreOffice или из других источников.

.. note:: Настройки для меню и панелей инструментов могут быть сохранены в шаблоне. Для этого сначала сохраните их в документе, а затем сохраните документ в качестве шаблона, как описано в *Главе 3 – Использование стилей и шаблонов*.

Настройка содержимого меню
--------------------------

В дополнение к изменению шрифта меню (описано в Главе 2, Настройка LibreOffice), можно добавлять и изменять категории в строке меню, добавлять команды в меню и вносить другие изменения. 
Для настройки меню:

1. Выберите пункт меню :menuselection:`Сервис --> Настройка`.
2. В диалоге *Настройка* выберите вкладку *Меню*.

.. _ch14-lo-screen-001:

.. figure:: _static/chapter14/ch14-lo-screen-001.png
    :scale: 50%
    :align: center
    :alt: Диалог Настройка. Вкладка Меню

    Диалог *Настройка*. Вкладка *Меню*

3. В выпадающем списке *Сохранить* в выберите, следует ли сохранить изменения меню для всего приложения (например, LibreOffice Writer) или только для выбранного документа (например, ``Ваш_файл.odt``). 
4. В разделе Меню LibreOffice [имя компонента (на рисунке выше это Writer)] выберите из выпадающего списка *Меню* название меню, которое необходимо настроить. Список содержит все основные меню, а также подменю (меню, которые содержатся в другом меню). Например, в дополнение к основным меню *Файл*, *Правка*, *Вид* и так далее, есть подменю *Файл | Отправить и Правка | Изменения*. Команды, доступные для выбранного меню, показаны в центральной части диалога. 
5. Чтобы настроить выбранный пункт меню, нажмите на кнопку *Изменить*. Также можно добавить команды в меню, нажав на кнопку *Добавить*. Эти действия описаны в последующих разделах. Используйте стрелки вверх и вниз рядом со списком элементов меню, чтобы переместить выбранный пункт меню в другое место. 
6. После завершения настроек нажмите кнопку *ОК* (не показана на рисунке выше), чтобы сохранить изменения.

Создание нового меню
~~~~~~~~~~~~~~~~~~~~

На вкладке *Меню* диалога *Настройка* нажмите на кнопку *Создать*, чтобы открыть диалог *Новое меню,* показанный.

1. Введите название для нового меню в соответствующем поле.
2. Используйте стрелки вверх и вниз, чтобы перемещать новое меню в желаемое положение в строке меню.
3. Нажмите кнопку *OK* для сохранения.

Новое меню станет доступно в списке меню в диалоге Настройки. (В самой строке меню новое меню появится после сохранения настроек.)

После создания нового меню в него необходимо добавить какие-либо команды, как это описано в разделе `Добавление команды в меню`_.

.. _ch14-lo-screen-002:

.. figure:: _static/chapter14/ch14-lo-screen-002.png
    :scale: 50%
    :align: center
    :alt: Добавление нового меню

    Добавление нового меню

Изменение существующего меню
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Добавление команды в меню
~~~~~~~~~~~~~~~~~~~~~~~~~


Изменение элементов меню
~~~~~~~~~~~~~~~~~~~~~~~~


------------

Настройка панелей инструментов
-------------------------------


Изменение существующих панелей инструментов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


Создание новой панели инструментов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Добавление команд на панель инструментов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Выбор значков для команд на панелях инструментов
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Пример: Добавление значка Факс на панель инструментов
"""""""""""""""""""""""""""""""""""""""""""""""""""""


Назначение сочетаний клавиш для выполнения действий
---------------------------------------------------

Пример: Назначение сочетаний клавиш для применения стилей
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""

Чтобы изменить стандартное или добавленное пользователем меню, выберите его в списке *Меню*, затем нажмите справа кнопку *Меню*, откроется выпадающий список со следующими вариантами действий: *Переместить*, *Переименовать*, *Удалить*. Не все из этих действий могут быть применены к некоторым записям в списке *Меню*. Например, команда *Переименовать* и *Удалить* не доступны для стандартных меню из поставки LibreOffice, а *Переместить* не доступна для подменю.

Чтобы переместить меню (например, *Файл*), выберите в выпадающем списке вариант *Переместить*. Откроется диалог, аналогичный показанному на рисунке 2 (только без поля для ввода названия меню). Используйте стрелки вверх и вниз для перемещения меню на необходимую позицию.

Чтобы переместить подменю (например, *Файл | Отправить*), выберите главное меню *Файл* в выпадающем списке *Меню*, затем в списке элементов меню выделите подменю *Отправить* и, используя стрелки вверх и вниз рядом со списком элементов, переместите подменю

Помимо переименования, можно в имени пользовательского меню выделить букву, которая будет подчеркнута, и будет использоваться в качестве ярлыка, что позволит выбрать это меню, нажав `Alt + эту букву` (например, :menuselection:`&Файл`). В существующих подменю также можно изменить такую букву. 

1. Выберите пользовательское меню или подменю в выпадающем списке *Меню*.
2. Нажмите на кнопку *Меню* и выберите *Переименовать*.
3. Добавьте тильду (`~`) перед буквой, которую вы хотите использовать в качестве ярлыка. Например, чтобы выбрать команду *Отправить* нажатием сочетания клавиш  ``Alt + О``, введите *~Отправить*. Если хотите назначить букву *Т*, то введите *О~тправить*.

.. note:: Можно использовать любые буквы в качестве ярлыков, даже уже используемые в командах меню. Тем не менее, желательно использовать неиспользуемые буквы, если это возможно, для упрощения использования функции.






Сохранение изменений комбинаций клавиш в файл
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Изменения в назначенных комбинациях клавиш могут быть сохранены в файле конфигурации клавиатуры для использования в более позднее время, что позволяет создавать и применять различные конфигурации по мере необходимости. Чтобы сохранить настройки сочетания клавиш в файле:

1. После назначения сочетаний клавиш нажмите кнопку *Сохранить* в правой части диалога (рисунок 6).
2. В диалоге *Сохранить* настройки клавиатуры выберите из списка тип файла Все файлы.
3. Далее введите имя для конфигурационного файла в поле *Имя файла* или найдите и  выберите существующий файл из списка.
4. Нажмите *Сохранить*. При попытке переписать существующий файл появится диалоговое окно с подтверждением перезаписи, в противном случае файл просто будет сохранен.

Загрузка сохранённого файла конфигурации
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Для загрузки сохраненного файла конфигурации и замены существующей конфигурации, нажмите кнопку *Загрузить* в правой части диалогового окна *Настройка*, а затем выберите файл конфигурации в диалоговом окне *Загрузить настройки клавиатуры*. 

Сброс настроек сочетаний клавиш
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы сбросить все сочетания клавиш к значениям по умолчанию, нажмите кнопку *Восстановить* в нижнем правом углу диалогового окна *Настройка*. Используйте эту функцию с осторожностью, поскольку при этом не будет показано никакого окна для подтверждения сброса. В значения по умолчанию будут установлены все сочетания без дополнительного уведомления.

Назначение макроса на событие
------------------------------

Когда что-то происходит в LibreOffice, то мы говорим, что произошло событие. Например, был открыт документ, была нажата клавиша или переместился курсор мыши. Можно связать макрос с событием так, что макрос будет запускаться, когда происходит событие. Распространено назначение макроса на событие *Открытие документа*, который выполняет определенные задачи при открытии документа в LibreOffice.

Чтобы назначить макрос на событие используйте вкладку *События* в диалоге *Настройка*. Более подробно это описано в *Главе 13* данного руководства.

---------------

Добавление функциональности, используя расширения
-------------------------------------------------

Установка расширений
~~~~~~~~~~~~~~~~~~~~

